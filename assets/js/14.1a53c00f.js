(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{507:function(s,t,n){"use strict";n.r(t);var a=n(4),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("目录")]),s._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#_1-安装-nginx"}},[s._v("1.  安装 nginx")])]),n("li",[n("a",{attrs:{href:"#_2-nginx配置文件"}},[s._v("2.  nginx配置文件")])]),n("li",[n("a",{attrs:{href:"#_3-nginx的正向代理和反向代理"}},[s._v("3.  Nginx的正向代理和反向代理")])]),n("li",[n("a",{attrs:{href:"#_4-关于nginx的location路径映射"}},[s._v("4.  关于Nginx的location路径映射")])]),n("li",[n("a",{attrs:{href:"#_5-nginx负载均衡-upstream"}},[s._v("5.  Nginx负载均衡：upstream")])]),n("li",[n("a",{attrs:{href:"#_6-nginx动静分离"}},[s._v("6.  Nginx动静分离")])]),n("li",[n("a",{attrs:{href:"#_7-nginx集群"}},[s._v("7.  Nginx集群")])]),n("li",[n("a",{attrs:{href:"#_8-nginx之前端相关配置"}},[s._v("8.  Nginx之前端相关配置")])]),n("li",[n("a",{attrs:{href:"#_9-nginx简单总结"}},[s._v("9.  Nginx简单总结")])])])]),n("p"),s._v(" "),n("hr"),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.bilibili.com/video/BV1W54y1z7GM",target:"_blank",rel:"noopener noreferrer"}},[s._v("b站地址--nginx"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/m0_49558851/article/details/107786372",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx笔记"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.w3cschool.cn/nginx/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx教程--w3c"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.runoob.com/w3cnote/nginx-setup-intro.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx教程--菜鸟教程"),n("OutboundLink")],1)]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_1-安装-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-nginx"}},[s._v("#")]),s._v(" 1.  安装 nginx")]),s._v(" "),n("h4",{attrs:{id:"_1-1-虚拟机安装docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-虚拟机安装docker"}},[s._v("#")]),s._v(" 1.1    虚拟机安装docker")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# root账户登录，查看内核版本--虚拟机装的Centos7，linux 3.10内核")]),s._v("\nuname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把yum包更新到最新")]),s._v("\nyum update\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置yum源")]),s._v("\nyum"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("config"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manager "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add-repo")]),s._v(" http:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("download"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("linux"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("centos"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo\nyum"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("config"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manager "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add-repo")]),s._v(" http:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("linux"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("centos"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用官方安装脚本自动安装")]),s._v("\ncurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fsSL https:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("  sh\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 遇到问题： No Presto metadata available for docker-ce-stable")]),s._v("\nyum install docker"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新 执行 Docker 安装脚本")]),s._v("\ncurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fsSL https:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("  sh\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\nsudo docker version\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 Docker 进程")]),s._v("\nsudo service docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 验证 docker 是否安装成功并在容器中执行一个测试的镜像")]),s._v("\nsudo docker run hello"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ------------- 增加用户 --------------------------------")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增加docker用户组")]),s._v("\nsudo groupadd docker\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  增加名字为 cookie  的用户")]),s._v("\nsudo gpasswd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a cookie docker\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker 服务重启")]),s._v("\nsudo service docker restart\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("h4",{attrs:{id:"_2-1-docker下安装nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-docker下安装nginx"}},[s._v("#")]),s._v(" 2.1 docker下安装nginx")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在/opt目录下创建docker_nginx目录")]),s._v("\ncd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt\nmkdir docker_nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建docker-compose.yml文件并编写下面的内容,保存退出")]),s._v("\nvim docker"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[s._v("version: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\nservices:\n  nginx:\n    restart: always\n    image: daocloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("library"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx:latest\n    container_name: nginx\n    ports:\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 80:80\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("执行 "),n("code",[s._v("docker-compose up -d")])]),s._v(" "),n("p",[s._v("打开网址：    "),n("code",[s._v("92.168.2.100:80")])]),s._v(" "),n("hr"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_2-nginx配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-nginx配置文件"}},[s._v("#")]),s._v(" 2.  nginx配置文件")]),s._v(" "),n("h4",{attrs:{id:"_2-1-nginx-配置文件和目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-nginx-配置文件和目录"}},[s._v("#")]),s._v(" 2.1  Nginx 配置文件和目录")]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf \t\t核心配置文件\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf \t\t默认http服务器配置文件\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("fastcgi_params \tfastcgi配置\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("scgi_params \t\tscgi配置\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("uwsgi_params \tuwsgi配置\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("types \t设置HTTP协议的Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Type")]),s._v("与扩展名对应关系的文件\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("modules \t\t基本共享库和内核模块\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("cache"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx \tNginx的缓存目录\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("log"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx \t\tNginx的日志目录\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx \t可执行命令\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("debug \t调试执行可执行命令\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("doc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("18"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0 \t帮助文档\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("doc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("18"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("COPYRIGHT \t版权声明\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("man"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("man8"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz \t手册\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这四个文件是用来配置守护进程管理的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("systemd"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("system"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("debug"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("systemd"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("system"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sysconfig"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sysconfig"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("debug\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这三个文件是编码映射文件，因为作者是俄国人")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("koi"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utf\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("koi"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("win\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("win"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utf \t\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("p",[s._v("==常用命令==")]),s._v(" "),n("ul",[n("li",[s._v("启动nginx:  "),n("code",[s._v("service nginx start")])]),s._v(" "),n("li",[s._v("检查nginx配置文件是否有语法错误："),n("code",[s._v("nginx -t")])]),s._v(" "),n("li",[s._v("关闭nginx:  "),n("code",[s._v("nginx -s stop")])]),s._v(" "),n("li",[s._v("重启nginx:  "),n("code",[s._v("nginx -s reload")])])]),s._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器id")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看当前nginx的配置需要【进入docker容器中】")]),s._v("\ndocker exec "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it 容器id bash\n\nroot@37136a6bbb58:"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nconf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d\tfastcgi_params\tkoi"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utf  koi"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("win  mime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("types  modules  nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf  scgi_params\tuwsgi_params  win"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器后")]),s._v("\ncd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h4",{attrs:{id:"_2-2-核心配置文件nginx-conf文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-核心配置文件nginx-conf文件"}},[s._v("#")]),s._v(" 2.2  核心配置文件nginx.conf文件")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("user  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以上为全局块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# worker_processes的数值越大，Nginx的并发能力就越强")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# error_log代表Nginx错误日志存放的位置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pid是Nginx运行的一个标识")]),s._v("\n\nevents "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    worker_connections  1024;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# events块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# worker_connections的数值越大，Nginx的并发能力就越强")]),s._v("\n\nhttp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    include       /etc/nginx/mime.types;\n    default_type  application/octet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stream;\n\n    access_log  /var/log/nginx/access.log  main;\n    sendfile        on;\n    keepalive_timeout  65;\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include /etc/nginx/conf.d/*.conf;")]),s._v("\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \tlisten       80;\n    \tlisten  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    \tserver_name  localhost;\n\n   \t\tlocation / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        \troot   /usr/share/nginx/html;\n       \t\tindex  index.html index.htm;\n    \t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# location块")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# root:将接受到的请求根据/usr/share/nginx/html去查找静态资源")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# index:默认去上述的路径中找到index.html或index.htm")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# server块")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# listen代表Nginx监听的端口号")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# server_name代表Nginx接受请求的IP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# include代表引入一个外部文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# include  /etc/nginx/mime.types;  存放着大量媒体类型---设置HTTP协议的Content-Type与扩展名对应关系的文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include /etc/nginx/conf.d/*.conf;\t引入了conf.d下以.conf为结尾的配置文件")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br")])]),n("h4",{attrs:{id:"_2-3-修改docker-compose文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-修改docker-compose文件"}},[s._v("#")]),s._v(" 2.3  修改docker-compose文件")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#退出容器\\关闭容器")]),s._v("\nexit\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭 nginx ")]),s._v("\ndocker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose down\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 docker-compose.yml")]),s._v("\nvi docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("增加数据卷\nvolumes:\n- /opt/docker_nginx/conf.d/:/etc/nginx/conf.d")]),s._v(" "),n("p",[s._v("当前/opt/docker_nginx/目录下的 conf.d 映射到  /etc/nginx 目录下的 conf.d")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" daocloud.io/library/nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token datetime number"}},[s._v("80:80")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /opt/docker_nginx/conf.d/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/nginx/conf.d\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新构建容器")]),s._v("\ndocker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose bulid\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新启动容器")]),s._v("\ndocker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose up "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("这时我们再次访问80端口是访问不到的，因为我们映射了数据卷之后还没有编写server块中的内容")]),s._v(" "),n("p",[s._v("我们在/opt/docker_nginx/conf.d下新建default.conf，并插入如下内容")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  listen  80;\n  listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n  server_name  localhost;\n\n  location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    root /usr/share/nginx/html;\n    index  index.html  index.html;\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("重启nginx： "),n("code",[s._v("docker-compose restart")])]),s._v(" "),n("hr"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_3-nginx的正向代理和反向代理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-nginx的正向代理和反向代理"}},[s._v("#")]),s._v(" 3.  Nginx的正向代理和反向代理")]),s._v(" "),n("h4",{attrs:{id:"_3-1-正向代理和反向代理-知识点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-正向代理和反向代理-知识点"}},[s._v("#")]),s._v(" 3.1   正向代理和反向代理---知识点")]),s._v(" "),n("blockquote",[n("p",[s._v("正向代理：\n1.正向代理服务是由客户端设立的\n2.客户端了解代理服务器和目标服务器都是谁\n3.帮助咱们实现突破访问权限，提高访问的速度，对目标服务器隐藏客户端的ip地址")])]),s._v(" "),n("blockquote",[n("p",[s._v("反向代理：\n1.反向代理服务器是配置在服务端的\n2.客户端不知道访问的到底是哪一台服务器\n3.达到负载均衡，并且可以隐藏服务器真正的ip地址")])]),s._v(" "),n("h4",{attrs:{id:"_3-1-nginx实现反向代理-案例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-nginx实现反向代理-案例"}},[s._v("#")]),s._v(" 3.1   Nginx实现反向代理  ---  案例")]),s._v(" "),n("p",[s._v("步骤：")]),s._v(" "),n("p",[s._v("准备一个目标服务器\n启动tomcat服务器\n编写nginx的配置文件(/opt/docker_nginx/conf.d/default.conf)，通过Nginx访问到tomcat服务器")]),s._v(" "),n("p",[s._v("准备tomcat服务器")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("docker run "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 8080"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("name tomcat  daocloud.io/library/tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8.5.15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jre8\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#或者已经下载了tomcat镜像")]),s._v("\ndocker run "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 8080"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("name tomcat 镜像的标识\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加数据卷")]),s._v("\ndocker run "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("v /宿主机绝对目录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/容器内目录 镜像名\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("default.conf文件内容如下")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    server_name  localhost;\n\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基于反向代理访问到tomcat服务器")]),s._v("\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080/;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("重启nginx： "),n("code",[s._v("docker-compose restart")])]),s._v(" "),n("p",[s._v("这时我们访问80端口可以看到8080端口tomcat的默认首页")]),s._v(" "),n("hr"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_4-关于nginx的location路径映射"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-关于nginx的location路径映射"}},[s._v("#")]),s._v(" 4.  关于Nginx的location路径映射")]),s._v(" "),n("h4",{attrs:{id:"_4-1-location路径映射-知识点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-location路径映射-知识点"}},[s._v("#")]),s._v(" 4.1   location路径映射---知识点")]),s._v(" "),n("p",[s._v("优先级关系：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("(location = ) "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" \n\t(location /xxx/yyy/zzz) "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" \n\t\t(location ^~) "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" \n\t\t\t(location ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("~"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("*)")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" \n\t\t\t\t(location /起始路径) "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" \n\t\t\t\t\t(location /)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ol",[n("li",[s._v("==精准匹配==：主机名后面不能带任何字符串")])]),s._v(" "),n("p",[s._v("例如www.baidu.com不能是www.baidu.com/id=xxx")]),s._v(" "),n("p",[n("code",[s._v("location / { }")])]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("==通用匹配==：匹配所有以/xxx开头的路径")])]),s._v(" "),n("p",[s._v("例如127.0.0.1:8080/xxx\txxx可以为空，为空则和=匹配一样")]),s._v(" "),n("p",[n("code",[s._v("location /xxx { }")])]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[s._v("==正则匹配==：匹配所有以/xxx开头的路径")])]),s._v(" "),n("p",[n("code",[s._v("location ~ /xxx {\t }")])]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[s._v("==匹配开头路径----异或==：匹配所有以/xxx/xx开头的路径")])]),s._v(" "),n("p",[n("code",[s._v("location ^~ /xxx/xx { }")])]),s._v(" "),n("ol",{attrs:{start:"5"}},[n("li",[s._v("==匹配结尾路径==： 匹配以.gif、.jpg或者.png结尾的路径")])]),s._v(" "),n("p",[n("code",[s._v("location ~* \\.(gif/jpg/png)$ { }")])]),s._v(" "),n("p",[s._v("== root与alias的区别==")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("\n server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    server_name  localhost;\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#root   html;")]),s._v("\n    alias  /data/admin/;\n    index  index.html index.htm;\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("访问 "),n("code",[s._v("192.12.13.1/data/admin/index.html")])]),s._v(" "),n("p",[s._v("root的处理结果是：root路径＋location路径\nalias的处理结果是：使用alias路径替换location路径")]),s._v(" "),n("p",[n("font",{attrs:{color:"green"}},[s._v("  alias后面必须要用“/”结束，否则会找不到文件的！！而root则可有可无~~ ")])],1),s._v(" "),n("h4",{attrs:{id:"_4-2-location路径映射-案例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-location路径映射-案例"}},[s._v("#")]),s._v(" 4.2   location路径映射 --- 案例")]),s._v(" "),n("p",[s._v("修改/opt/docker_nginx/conf.d/default.conf  如下， "),n("font",{attrs:{color:"blue"}},[s._v(" 优先级 越高  越写在前面   ")]),s._v("  。")],1),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    server_name  localhost;\n\n\tlocation /index "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8081/;\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tomcat首页")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\tlocation ^~ /CR/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080/CR/;\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#毕设前台首页")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080/CRAdmin/;\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#毕设后台首页")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("重启nginx： "),n("code",[s._v("docker-compose restart")])]),s._v(" "),n("p",[s._v("访问"),n("code",[s._v("{$本机IP}/index")]),s._v("可以进入tomcat首页\n访问"),n("code",[s._v("{$本机IP}/CR/XXX")]),s._v("可以进入毕设前台首页\n访问"),n("code",[s._v("{$本机IP}")]),s._v("或者"),n("code",[s._v("{$本机IP}:80")]),s._v("可以进入毕设后台首页")]),s._v(" "),n("hr"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_5-nginx负载均衡-upstream"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-nginx负载均衡-upstream"}},[s._v("#")]),s._v(" 5.  Nginx负载均衡：upstream")]),s._v(" "),n("p",[s._v("Nginx为我们默认提供了三种负载均衡的策略：")]),s._v(" "),n("ol",[n("li",[s._v("轮询：\n将客户端发起的请求，平均分配给每一台服务器")]),s._v(" "),n("li",[s._v("权重：\n将客户端的请求，根据服务器的权重值不同，分配不同的数量")]),s._v(" "),n("li",[s._v("ip_hash:\n基于发起请求的客户端的ip地址不同，他始终会将请求发送到指定的服务器上\n就是说如果这个客户端的请求的ip地址不变，那么处理请求的服务器将一直是同一个")])]),s._v(" "),n("h4",{attrs:{id:"_5-1-轮询-实现nginx轮询负载均衡机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-轮询-实现nginx轮询负载均衡机制"}},[s._v("#")]),s._v(" 5.1，轮询：实现Nginx轮询负载均衡机制")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("upstream my_serverName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080;\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8081;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    server_name  localhost;\n\n\tlocation / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass   http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//my_serverName/;\t  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tomcat首页")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("  总结  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("\nupstream 名字"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("port;\n    server 域名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("端口;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    server_name  localhost;\n\n\tlocation / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$upstream的名字"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/;\t\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("p",[s._v("1， upstream 声明应该在 server  之前；\n2， upstream 的 实例名字 最好不要有下划线_")]),s._v(" "),n("p",[s._v("重启nginx： "),n("code",[s._v("docker-compose restart")])]),s._v(" "),n("p",[s._v("多次刷新"),n("code",[s._v("{$本机IP}")]),s._v("页面，根据版本号我们可以发现我们进入的是不同的tomcat")]),s._v(" "),n("h4",{attrs:{id:"_5-2-权重-在配置文件中upstream块中加上weight"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-权重-在配置文件中upstream块中加上weight"}},[s._v("#")]),s._v(" 5.2，权重：在配置文件中upstream块中加上weight")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("upstream my_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080   weight=10;\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8081   weight=2;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    server_name  localhost;\n\n\tlocation / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$upstream的名字"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/;\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tomcat首页")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h4",{attrs:{id:"_5-3-ip-hash-在配置文件upstream块中加上ip-hash"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-ip-hash-在配置文件upstream块中加上ip-hash"}},[s._v("#")]),s._v(" 5.3， ip_hash：在配置文件upstream块中加上ip_hash")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("upstream my_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tip_hash;\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8080;\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$本机IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8081;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       80;\n    listen  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80;\n    server_name  localhost;\n\n\tlocation / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("$upstream的名字"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/;\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tomcat首页")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h4",{attrs:{id:"_5-4-健康检查-检查是否有服务器处于异常状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-健康检查-检查是否有服务器处于异常状态"}},[s._v("#")]),s._v(" 5.4， 健康检查： 检查是否有服务器处于异常状态")]),s._v(" "),n("p",[s._v("Nginx 自带 ngx_http_upstream_module（健康检测模块）本质上服务器心跳的检查，通过定期轮询向集群里的服务器发送健康检查请求,来检查集群中是否有服务器处于异常状态；")]),s._v(" "),n("p",[s._v("如果某台服务器异常，客户端请求nginx反向代理进来的都不会被发送到该服务器上（直至下次轮训健康检查正常）")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("upstream backserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  server 192.168.0.1  max_fails=1 fail_timeout=40s;\n  server 192.168.0.2  max_fails=1 fail_timeout=40s;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ol",[n("li",[n("code",[s._v("fail_timeout")]),s._v(" : 设定服务器被认为不可用的时间段以及统计失败尝试次数的时间段，默认为10s")]),s._v(" "),n("li",[n("code",[s._v("max_fails")]),s._v(" : 设定Nginx与服务器通信的尝试失败的次数，默认为：1次")])]),s._v(" "),n("hr"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_6-nginx动静分离"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-nginx动静分离"}},[s._v("#")]),s._v(" 6.  Nginx动静分离")]),s._v(" "),n("h4",{attrs:{id:"_6-1-nginx动静分离-知识点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-nginx动静分离-知识点"}},[s._v("#")]),s._v(" 6.1  Nginx动静分离 --- 知识点")]),s._v(" "),n("p",[s._v("Nginx的并发能力公式：")]),s._v(" "),n("p",[n("code",[s._v("worker_processes * worker_connections / 4 | 2 = Nginx最终的并发能力")])]),s._v(" "),n("p",[s._v("动态资源需要/4，静态资源需要/2\nNginx通过动静分离来提升Nginx的并发能力，更快的给用户响应")]),s._v(" "),n("p",[s._v("==动态资源代理==")]),s._v(" "),n("p",[n("code",[s._v("location / { proxy_pass 路径; }")])]),s._v(" "),n("p",[s._v("==静态资源代理==")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("location  /  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    root  静态资源路径;\n    index  默认访问路径下的什么资源;\n    autoindex on;  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#代表展示静态资源的全部内容，以列表的形式展开")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"_6-2-nginx动静分离-案例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-nginx动静分离-案例"}},[s._v("#")]),s._v(" 6.2  Nginx动静分离 --- 案例")]),s._v(" "),n("p",[s._v("步骤：")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("停掉nginx： "),n("code",[s._v("docker-compose down")]),s._v(" ;")])]),s._v(" "),n("li",[n("p",[s._v("修改 "),n("code",[s._v("/opt/docker_nginx/docker-compose.yml")]),s._v(" 添加静态资源数据卷，映射到nginx服务器的一个目录")])])]),s._v(" "),n("p",[s._v("volumes:\n-  /opt/docker_nginx/conf.d/:/etc/nginx/conf.d\n-  /opt/docker_nginx/html/:/data/html\n-  /opt/docker_nginx/img/:/data/img")]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[n("p",[s._v("创建nginx： "),n("code",[s._v("docker-compose up -d")]),s._v(" ;")])]),s._v(" "),n("li",[n("p",[s._v("在 /opt/docker_nginx/html/ 目录下创建并编辑： "),n("code",[s._v("vi index.html")]),s._v("  ;\n在 /opt/docker_nginx/img/ 目录下ftp  放入一张图片： \t"),n("code",[s._v("mv 1.jpg /opt/docker_nginx/img/")]),s._v("  ;")])]),s._v(" "),n("li",[n("p",[s._v("修改配置文件   "),n("code",[s._v("/opt/docker_nginx/conf.d/default.conf")])])])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 代理到html静态资源")]),s._v("\nlocation /html "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   \troot  /data;\n    index  index.html;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 代理到 img 静态资源")]),s._v("\nlocation /img "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   \troot  /data;\n    autoindex  on;   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列表的形式展示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("ol",{attrs:{start:"6"}},[n("li",[s._v("重启nginx：  "),n("code",[s._v("docker-compose restart")]),s._v("\n访问"),n("code",[s._v("{$本机IP}/html")]),s._v("   查看 html静态资源，访问"),n("code",[s._v("{$本机IP}/img")]),s._v("   查看 img静态资源")])]),s._v(" "),n("hr"),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"_7-nginx集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-nginx集群"}},[s._v("#")]),s._v(" 7.  Nginx集群")]),s._v(" "),n("p",[s._v("单点故障，避免nginx的宕机，导致整个程序的崩溃\n准备多台Nginx\n准备keepalived，监听nginx的健康情况\n准备haproxy，提供一个虚拟的路径，统一的去接收用户的请求")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201103095826308.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),n("hr"),s._v(" "),n("hr"),n("p"),s._v(" "),n("h2",{attrs:{id:"_8-nginx之前端相关配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-nginx之前端相关配置"}},[s._v("#")]),s._v(" 8.  Nginx之前端相关配置")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/MovMnSaqAPLoJuZleiQZUQ",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考111"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"_8-1-适配pc与移动环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-适配pc与移动环境"}},[s._v("#")]),s._v(" 8.1  适配PC与移动环境")]),s._v(" "),n("p",[s._v("当用户从移动端打开PC端baidu.com的场景时，将自动跳转指移动端m.baidu.com，本质上是Nginx可以通过内置变量"),n("code",[s._v("$http_user_agent")]),s._v("，获取到请求客户端的userAgent，从而知道当前用户当前终端是移动端还是PC，进而重定向到H5站还是PC站")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    if ($http_user_agent ~* '(Android"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("webOS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("iPhone)') "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移动、pc设备agent获取")]),s._v("\n      set $mobile_request '1';\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    if ($mobile_request = '1') "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      rewrite ^.+ http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//m.baidu.com;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("hr"),s._v(" "),n("h4",{attrs:{id:"_8-2-配置gzip"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-配置gzip"}},[s._v("#")]),s._v(" 8.2  配置gzip")]),s._v(" "),n("p",[s._v("开启Nginx gzip，压缩后，静态资源的大小会大大的减少，从而可以节约大量的带宽,提高传输效率，带来更好的响应和体验")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  gzip on; //启动\n  gzip_buffers 32 4K;\n  gzip_comp_level 6; //压缩级别，1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v('10，数字越大压缩的越好\n  gzip_min_length 100; //不压缩临界值，大于100的才压缩，一般不用改\n  gzip_types application/javascript text/css text/xml;\n  gzip_disable "MSIE '),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\\."; // IE6对Gzip不友好，对Gzip\n  gzip_vary on;\n'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("hr"),s._v(" "),n("h4",{attrs:{id:"_8-3-nginx配置跨域请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-nginx配置跨域请求"}},[s._v("#")]),s._v(" 8.3  Nginx配置跨域请求")]),s._v(" "),n("p",[s._v("==403跨域错误==")]),s._v(" "),n("p",[s._v("当出现403跨域错误的时候，还有 "),n("code",[s._v("No 'Access-Control-Allow-Origin' header is present on the requested resource")]),s._v(" 报错等，需要给Nginx服务器配置响应的header参数：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  add_header Access"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Control"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Allow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Origin "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("*;")]),s._v("\n  add_header Access"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Control"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Allow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Methods 'GET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" POST"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" OPTIONS';\n  add_header Access"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Control"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Allow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Headers 'DNT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Mx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ReqToken"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Keep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Alive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("User"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Agent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Requested"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("With"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("If"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Modified"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Since"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Control"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Authorization';\n\n  if ($request_method = 'OPTIONS') "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    return 204;\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("==跨域代理==")]),s._v(" "),n("p",[s._v("需求背景： 以vue-cli构建后的项目，打包后生产静态文件，其中有个index.html文件。")]),s._v(" "),n("p",[s._v("在开发模式下，我们可以通过devServer下的proxy来代理跨域，然后，打包后，打开index.html, devServer可不会执行。这个时候我们便可通过nginx代理跨域, 如下：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#请求跨域，这里约定代理请求url path是以/api/开头")]),s._v("\nlocation ^~/api/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  rewrite ^/api/(."),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("*)$")]),s._v(" /$1 break;\n  proxy_pass 172.183.23.4;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里重写了请求，将正则匹配中的第一个()中$1的path，")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拼接到真正的请求后面，并用break停止后续匹配")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("如本地请求时"),n("code",[s._v("localhost/api/getList")]),s._v(", 经过nginx跨域代理，实际请求地址为 "),n("code",[s._v("172.183.23.4/getList")]),s._v("，实现跨域代理")]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_8-4-nginx-配置https-ssl-认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-nginx-配置https-ssl-认证"}},[s._v("#")]),s._v(" 8.4  Nginx 配置Https -- SSL 认证")]),s._v(" "),n("p",[s._v("两个步骤：签署第三方可信任的 SSL 证书 和 配置 HTTPS")]),s._v(" "),n("ol",[n("li",[s._v("==签署第三方可信任的 SSL==")])]),s._v(" "),n("p",[s._v("配置 HTTPS 要用到私钥 example.key 文件和 example.crt 证书文件，而申请证书文件的时候要用到 example.csr 文件")]),s._v(" "),n("p",[s._v("1）生成密钥 .key :\n"),n("code",[s._v("openssl genrsa -out nginx_quick.key 1024")])]),s._v(" "),n("p",[s._v("2）生成证书签名请求文件 .csr ：\n"),n("code",[s._v("openssl req -new -key nginx_quick.key -out nginx_quick.csr")])]),s._v(" "),n("p",[s._v("3）生成证书签名文件 .crt :：\n"),n("code",[s._v("openssl x509 -req -days 3650 -in nginx_quick.csr -signkey nginx_quick.key -out nginx_quick.crt")])]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("==Nginx配置https==")])]),s._v(" "),n("p",[s._v("要开启 HTTPS 服务，在配置文件信息块(server)，必须使用监听命令 listen 的 ssl 参数和定义服务器证书文件和私钥文件")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ssl参数")]),s._v("\n  listen              443 ssl;   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监听443端口，因为443端口是https的默认端口。80为http的默认端口")]),s._v("\n  server_name         example.com;\n  ssl_certificate     /etc/nginx/ssl_cert/nginx_quick.crt;    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#证书文件---证书的绝对路径")]),s._v("\n  ssl_certificate_key /etc/nginx/ssl_cert/nginx_quick.key;    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#私钥文件---密钥的绝对路径")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[s._v("==修改 docker-compose.yml： 把自定义证书文件传到 Nginx 的对应路径下==")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务的名称")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件夹映射")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./nginx/nginx.conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/nginx/nginx.conf "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx 配置文件")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./nginx/ssl_cert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/nginx/ssl_cert "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 证书文件")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 端口转发")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"443:443"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("重启后访问 "),n("code",[s._v("https://localhost")]),s._v("，发现页面被 Chrome 标记为不安全访问，这是因为自签证书是无效证书导致的，点击「继续前往」可正常访问到页面：")]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_8-5-页面缓存-代理缓存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-页面缓存-代理缓存"}},[s._v("#")]),s._v(" 8.5  页面缓存 --- 代理缓存")]),s._v(" "),n("p",[s._v("页面缓存主要分为三类：客户端缓存、代理缓存、服务端缓存")]),s._v(" "),n("p",[s._v("当 Nginx 做代理时，假如接收的大多是一些响应数据不怎么变化的请求，比如静态资源请求，使用 Nginx 缓存将大幅度提升请求速度。")]),s._v(" "),n("p",[s._v("Nginx 中的缓存是以文件系统上的分层数据存储的形式实现的，缓存键可配置，并且可以使用不同的特定于请求的参数来控制进入缓存的内容。")]),s._v(" "),n("p",[s._v("Nginx 利用 "),n("code",[s._v("proxy_cache_path")]),s._v(" 和 "),n("code",[s._v("proxy_cache")]),s._v(" 来开启内容缓存，前者用来设置缓存的路径和配置，后者用来启用缓存")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("http "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  proxy_cache_path /data/nginx/cache levels=1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("2 keys_zone=mycache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("10m max_size=10g inactive=60m;\n\n  server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    proxy_cache mycache;\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("上边设置了一个缓存 mycache，并在 server 中启用：")]),s._v(" "),n("p",[s._v("1）"),n("code",[s._v("/data/nginx/cache")]),s._v(" 指定了本地缓存的根目录；")]),s._v(" "),n("p",[s._v("2）"),n("code",[s._v("level")]),s._v(" 代表缓存目录结构是两层的，最多设置3层，数字代表命名长度，比如 1:2 就会生成诸如 /data/nginx/cache/w/0d 的目录，对于大量缓存场景，合理的分层缓存是必要的；")]),s._v(" "),n("p",[s._v("3）"),n("code",[s._v("keys_zone")]),s._v(" 设置了一个共享内存区，10m 代表内存区的大小，该内存区用于存储缓存键和元数据，保证 Nginx 在不检索磁盘的情况下能够快速判断出缓存是否命中；")]),s._v(" "),n("p",[s._v("4）"),n("code",[s._v("max_size")]),s._v("  设置了缓存的上限，默认是不限制；")]),s._v(" "),n("p",[s._v("5）"),n("code",[s._v("inactive")]),s._v("  设置了缓存在未被访问时能够持续保留的最长时间，也就是失活时间。")]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_8-6-nginx-替换前端页面的样式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-nginx-替换前端页面的样式"}},[s._v("#")]),s._v(" 8.6  Nginx 替换前端页面的样式")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    root /usr/share/nginx/html;\n    index index.html index.htm;\n    try_files $uri $uri/ /index.html;\n    proxy_ssl_verify off;\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一个参数是要被替换的，第二个参数是替换后的")]),s._v("\n    sub_filter '</head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("' '</head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" <style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(".el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" .el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("aside"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" .el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" .el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("header"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("display")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" none;"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("</style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("';\n    sub_filter_once off; "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#替换所有的，默认是on，替换第一个")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h2",{attrs:{id:"_9-nginx简单总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-nginx简单总结"}},[s._v("#")]),s._v(" 9.  Nginx简单总结")]),s._v(" "),n("p",[s._v("==nginx  替换 样式（头部、左侧导航菜单）==")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("location "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        index index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        try_files $uri $uri"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        proxy_ssl_verify off"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        # 第一个参数是要被替换的，第二个参数是替换后的\n        sub_filter "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'</head>'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'</head> <style>.el-container > .el-aside, .el-container > .el-header{display: none;}</style>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        sub_filter_once off"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" #替换所有的，默认是on，替换第一个\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200826191712594.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/202008261923015.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200826192651898.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200826193911528.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[s._v("负载均衡")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200826195449834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200826195515367.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200826195608366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ltYWdlX2Z6eA==,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);